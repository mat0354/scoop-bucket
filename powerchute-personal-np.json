{
    "version": "310",
    "description": "Easy-to-use, safe system shutdown software with power and energy management features for home computers and battery backups.",
    "homepage": "https://www.se.com/ww/en/product-range/61934-powerchute-personal-edition/",
    "license": "",
    "architecture": {
        "32bit": {
            "url": "https://download.schneider-electric.com/files?p_Doc_Ref=APC_PCPE_310#/PCPE.exe",
            "hash": "06cdb01b2e23ed72452ff090212ba72b5a250c16c41485ecd05d4ac9f75e25ff"
        }
    },
    "installer": {
        "script": [
            "if (-Not (is_admin)) { error 'Administrator privileges needed'; break }",
            "$SetupPath = \"$env:SCOOP\\cache\\powerchute-personal-np#$version#https_download.schneider-electric.com_PCPE.exe\"",
            "$InstallExitCode = (Start-Process -Wait $SetupPath \"/s\" -Verb RunAs -Passthru).ExitCode",
            "if ($InstallExitCode -ne 0) { abort \"Install failed with ExitCode [$InstallExitCode].\" }",
            "#Restart-Service -Name TSGateway",
            "#Remove-Item -Path \"$dir\\Duo Security\" -Recurse"
        ]
    },
    "uninstaller": {
        "script": [
            "if (-Not (is_admin)) { error 'Administrator privileges needed'; break }",
            "#$IdentifyingNumber = (Get-WmiObject -Class Win32_Product -Filter \"Name = 'power'\").IdentifyingNumber",
            "#$UninstallExitCode = (Start-Process -Wait msiexec \"/x `\"$IdentifyingNumber`\" /qn /L*v `\"$dir\\duo-rdgateway-uninstall.log`\"\" -Verb RunAs -Passthru).ExitCode",
            "#if ($UninstallExitCode -ne 0) { abort \"Uninstall failed with ExitCode [$UninstallExitCode]. See log for details:`n$dir\\duo-rdgateway-uninstall.log\" }",
            "#Restart-Service -Name TSGateway"
        ]
    },
    "checkver": {
        "url": "https://www.se.com/ww/en/product-range/61934-powerchute-personal-edition/#software-and-firmware",
        "regex": "https:\\/\\/download\\.schneider-electric\\.com\/files\\?p_Doc_Ref=APC_PCPE_(?<version>[\\d]+)"
    },
    "autoupdate": {
        "architecture": {
            "32bit": {
                "url": "https://download.schneider-electric.com/files?p_Doc_Ref=APC_PCPE_$version#/PCPE.exe"
            }
        }
    }
}
